import{w as g}from"./index-d8ed1bec.js";import{p as d,s as u}from"./parse-with-big-int-561ccb8b.js";const h=e=>typeof e=="function";function S(e,r=null,w=!1){var i,a,l;let s=h(r)?r():r,o;try{(i=window==null?void 0:window.localStorage)!=null&&i.getItem(e)&&(s=d((l=(a=window==null?void 0:window.localStorage)==null?void 0:a.getItem(e))!=null?l:""))}catch{s=null}const{subscribe:f,set:n}=g(s);if(w)try{o=new BroadcastChannel(`persist-store-${e}`),o==null||o.addEventListener("message",t=>{n(t.data)})}catch{console.error("Browser does not support BroadcastChannel")}return{subscribe:f,set:t=>{var c,p;o&&o.postMessage(t),t===null?(c=window==null?void 0:window.localStorage)==null||c.removeItem(e):(p=window==null?void 0:window.localStorage)==null||p.setItem(e,u(t)),n(t)}}}export{h as i,S as p};
