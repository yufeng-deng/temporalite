import{h as O}from"./has-c7a26a56.js";const R=["workflowExecutionStartedEventAttributes","workflowExecutionCompletedEventAttributes","workflowExecutionFailedEventAttributes","workflowExecutionTimedOutEventAttributes","workflowTaskStartedEventAttributes","workflowTaskScheduledEventAttributes","workflowTaskCompletedEventAttributes","workflowTaskTimedOutEventAttributes","workflowTaskFailedEventAttributes","activityTaskScheduledEventAttributes","activityTaskCompletedEventAttributes","activityTaskStartedEventAttributes","activityTaskFailedEventAttributes","activityTaskTimedOutEventAttributes","timerStartedEventAttributes","timerFiredEventAttributes","activityTaskCancelRequestedEventAttributes","activityTaskCanceledEventAttributes","timerCanceledEventAttributes","markerRecordedEventAttributes","workflowExecutionSignaledEventAttributes","workflowExecutionTerminatedEventAttributes","workflowExecutionCancelRequestedEventAttributes","workflowExecutionCanceledEventAttributes","requestCancelExternalWorkflowExecutionInitiatedEventAttributes","requestCancelExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionCancelRequestedEventAttributes","workflowExecutionContinuedAsNewEventAttributes","startChildWorkflowExecutionInitiatedEventAttributes","startChildWorkflowExecutionFailedEventAttributes","childWorkflowExecutionStartedEventAttributes","childWorkflowExecutionCompletedEventAttributes","childWorkflowExecutionFailedEventAttributes","childWorkflowExecutionCanceledEventAttributes","childWorkflowExecutionTimedOutEventAttributes","childWorkflowExecutionTerminatedEventAttributes","signalExternalWorkflowExecutionInitiatedEventAttributes","signalExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionSignaledEventAttributes","upsertWorkflowSearchAttributesEventAttributes"],q=t=>{for(const e of R)if(e in t)return e},L=(t,e)=>t[e],et=t=>{const e=q(t),r=L(t,e);return{key:e,attributes:r}},i=t=>e=>Boolean(e[t]),it=i("workflowExecutionCompletedEventAttributes"),G=i("workflowExecutionFailedEventAttributes"),N=i("workflowExecutionTimedOutEventAttributes"),$=i("workflowTaskTimedOutEventAttributes"),B=i("workflowTaskFailedEventAttributes"),A=i("activityTaskScheduledEventAttributes"),K=i("activityTaskStartedEventAttributes"),M=i("activityTaskCompletedEventAttributes"),v=i("activityTaskFailedEventAttributes"),b=i("activityTaskTimedOutEventAttributes"),w=i("timerStartedEventAttributes"),_=i("timerFiredEventAttributes"),j=i("activityTaskCancelRequestedEventAttributes"),m=i("activityTaskCanceledEventAttributes"),T=i("timerCanceledEventAttributes"),E=i("markerRecordedEventAttributes"),x=i("workflowExecutionSignaledEventAttributes"),z=i("workflowExecutionTerminatedEventAttributes"),D=i("workflowExecutionCanceledEventAttributes"),C=i("startChildWorkflowExecutionInitiatedEventAttributes"),H=i("childWorkflowExecutionStartedEventAttributes"),J=i("childWorkflowExecutionCompletedEventAttributes"),P=i("childWorkflowExecutionFailedEventAttributes"),Q=i("childWorkflowExecutionCanceledEventAttributes"),U=i("childWorkflowExecutionTimedOutEventAttributes"),h=i("childWorkflowExecutionTerminatedEventAttributes"),W=i("signalExternalWorkflowExecutionInitiatedEventAttributes"),V=i("signalExternalWorkflowExecutionFailedEventAttributes"),y=t=>{var r,o,n,a,c,u;const e=(a=(n=(o=(r=t==null?void 0:t.markerRecordedEventAttributes)==null?void 0:r.details)==null?void 0:o.data)==null?void 0:n.payloads)==null?void 0:a[0];return E(t)&&((c=t==null?void 0:t.markerRecordedEventAttributes)==null?void 0:c.markerName)==="LocalActivity"&&Boolean((u=e==null?void 0:e.ActivityType)!=null?u:e==null?void 0:e.activity_type)},S=t=>b(t)||v(t)||G(t)||N(t)||$(t)||B(t)||P(t)||U(t)||V(t),rt=t=>f(t)?t.isFailureOrTimedOut:S(t),g=t=>m(t)||T(t)||D(t)||Q(t),nt=t=>f(t)?t.isCanceled:g(t),I=t=>z(t)||h(t),ot=t=>f(t)?t.isTerminated:I(t),p=t=>K(t)?String(t.activityTaskStartedEventAttributes.scheduledEventId):m(t)?String(t.activityTaskCanceledEventAttributes.scheduledEventId):j(t)?String(t.activityTaskCancelRequestedEventAttributes.scheduledEventId):v(t)?String(t.activityTaskFailedEventAttributes.scheduledEventId):b(t)?String(t.activityTaskTimedOutEventAttributes.scheduledEventId):M(t)?String(t.activityTaskCompletedEventAttributes.scheduledEventId):H(t)?String(t.childWorkflowExecutionStartedEventAttributes.initiatedEventId):h(t)?String(t.childWorkflowExecutionTerminatedEventAttributes.initiatedEventId):J(t)?String(t.childWorkflowExecutionCompletedEventAttributes.initiatedEventId):_(t)?String(t.timerFiredEventAttributes.startedEventId):T(t)?String(t.timerCanceledEventAttributes.startedEventId):t.id,X=t=>{var e,r,o,n,a,c,u,l,s;if(!!t){if(A(t))return(r=(e=t.activityTaskScheduledEventAttributes)==null?void 0:e.activityType)==null?void 0:r.name;if(w(t))return`Timer ${(o=t.timerStartedEventAttributes)==null?void 0:o.timerId} (${(n=t.timerStartedEventAttributes)==null?void 0:n.startToFireTimeout})`;if(W(t))return`Signal: ${(a=t.signalExternalWorkflowExecutionInitiatedEventAttributes)==null?void 0:a.signalName}`;if(x(t))return`Signal received: ${(c=t.workflowExecutionSignaledEventAttributes)==null?void 0:c.signalName}`;if(E(t))return y(t)?"Local Activity":`Marker: ${(u=t.markerRecordedEventAttributes)==null?void 0:u.markerName}`;if(C(t))return`Child Workflow: ${(s=(l=t.startChildWorkflowExecutionInitiatedEventAttributes)==null?void 0:l.workflowType)==null?void 0:s.name}`}},k=({events:t})=>{let e=0,r;for(const o of t.values()){const n=Number(o.id);n>=e&&(e=n,r=o)}return r},d=t=>{const e=p(t),r=X(t),{timestamp:o,category:n,classification:a}=t,c=t,u=new Map,l=new Set;return u.set(t.id,t),l.add(t.id),{id:e,name:r,events:u,eventIds:l,initialEvent:c,timestamp:o,category:n,classification:a,get eventTime(){var s;return(s=this.lastEvent)==null?void 0:s.eventTime},get attributes(){var s;return(s=k(this))==null?void 0:s.attributes},get eventList(){return Array.from(this.events,([s,F])=>F)},get lastEvent(){return k(this)},get isFailureOrTimedOut(){return Boolean(this.eventList.find(S))},get isCanceled(){return Boolean(this.eventList.find(g))},get isTerminated(){return Boolean(this.eventList.find(I))}}},Y=t=>{if(A(t)||C(t)||w(t)||W(t)||x(t))return d(t);if(E(t))return y(t),d(t)},Z=(t,e)=>{!t||(t.events.set(e.id,e),t.eventIds.add(e.id),t.timestamp=e.timestamp)},st=t=>{const e={};for(const r of t){const o=p(r),n=Y(r);n?e[n.id]=n:Z(e[o],r)}return Object.values(e)},f=t=>t==null?!1:O(t,"events");export{f as a,y as b,nt as c,ot as d,rt as e,et as f,st as g,it as i};
